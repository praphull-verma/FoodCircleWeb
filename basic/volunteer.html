<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Volunteer - FoodCircle</title>
  <link rel="stylesheet" href="styles/styles.css">
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""
  />
  <style>
    /* These styles are specific to the map layout */
    main.vol-container {
      max-width: 1200px;
      margin: 2rem auto;
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }
    .pickup-list-container {
      flex: 1 1 350px; /* Flex properties for side-by-side layout */
      background: #fff;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.1);
      max-height: 600px;
      overflow-y: auto;
    }
    #map {
      flex: 2 1 600px; /* Map takes more space */
      height: 600px;
      border-radius: 10px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }
    @media(max-width: 800px) {
      main.vol-container { flex-direction: column; }
      #map { height: 400px; order: -1; } /* Show map on top on mobile */
      .pickup-list-container { max-height: none; }
    }
  </style>
</head>
<body>
  <header class="vol-banner">
    <div class="header-auth" id="auth-links"></div>
    <h1>Volunteer with FoodCircle</h1>
    <p>Pick up food donations and deliver them to those in need.</p>
  </header>

  <main class="vol-container">
    <div class="pickup-list-container">
      <h2>Available Pickup Locations in Pune</h2>
      <div class="pickup-list" id="pickupList">
        </div>
    </div>
    <div id="map"></div>
  </main>

  <footer class="footer">
    <p>© 2025 FoodCircle • Together, we can end hunger</p>
  </footer>

  <script
    src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
    crossorigin=""
  ></script>
  <script>
    // --- MAP AND LOCATION SCRIPT ---
    const locations = [
      { title: 'Shivaji Nagar Market', description: 'Pickup fresh meals from 11 AM - 1 PM.', address: 'Shivaji Nagar Market, Pune', lat: 18.5204, lng: 73.8567 },
      { title: 'Swargate Bus Stand', description: 'Food packets available from 4 PM - 6 PM.', address: 'Swargate Bus Stand, Pune', lat: 18.5024, lng: 73.8597 },
      { title: 'Kothrud Depot', description: 'Pickup and deliver meals, 12 PM - 2 PM.', address: 'Kothrud Bus Depot, Pune', lat: 18.5044, lng: 73.8144 },
      { title: 'Camp Area', description: 'Collection every morning at 10 AM.', address: 'MG Road, Camp, Pune', lat: 18.5167, lng: 73.8563 },
      { title: 'Hadapsar Industrial Area', description: 'Evening pickups from 5 PM - 7 PM.', address: 'Hadapsar Industrial Area, Pune', lat: 18.5031, lng: 73.9316 }
    ];
    const map = L.map('map').setView([18.5204, 73.8567], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    const pickupList = document.getElementById('pickupList');
    locations.forEach(loc => {
      const mapsUrl = `https://maps.google.com/?q=${encodeURIComponent(loc.address)}`;
      // Add marker to map
      L.marker([loc.lat, loc.lng]).addTo(map).bindPopup(
        `<b>${loc.title}</b><br>${loc.description}<br><a href="${mapsUrl}" target="_blank">Get Directions</a>`
      );
      // Add card to list
      const card = document.createElement('div');
      card.className = 'pickup-card';
      card.innerHTML = `
        <div>
          <h3>${loc.title}</h3>
          <p>${loc.description}</p>
        </div>
        <button onclick="window.open('${mapsUrl}', '_blank')">Directions</button>
      `;
      pickupList.appendChild(card);
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const authLinksContainer = document.getElementById('auth-links');
        if (!authLinksContainer) return;

        const currentUser = localStorage.getItem('currentUser');
        if (currentUser) {
            authLinksContainer.innerHTML = `
                <span>Welcome, ${currentUser}!</span>
                <button id="logoutButton">Logout</button>
            `;
            document.getElementById('logoutButton').addEventListener('click', () => {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            });
        } else {
            authLinksContainer.innerHTML = `
                <a href="login.html">Login</a>
                <a href="signup.html">Sign Up</a>
            `;
        }
    });
  </script>
</body>
</html>